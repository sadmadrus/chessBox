# Описание сервиса игровых сессий

## Обрабатываемые запросы

### TRACE
Проверка работоспособности сервиса
#### Возвращаемые ответы:
    200 - Ok - сервер и все связанные сервисы работают штатно
    500 - Internal Server Error - один из сервисов не доступен

### POST
Используется для начала игровой сессии. В теле запроса содержатся следующие данные:
    - first_client_ID - идентификатор первого клиента (игрока)
    - second_client_ID - идентификатор второго клиента (игрока)
    - timestamp - штамп времени инициатора партии в Unix-time
#### Возвращаемые ответы:
    201 - Ok - второй игрок согласен играть, в БД создана новая партия. В теле ответа получен идентификатор игровой сессии, первоначальная доска в формате FEN/UsFEN.
    406 - Not Acceptable - второй игрок отказался от игры
    500 - Internal Server Error - один из сервисов не доступен или в ходе обработки произошли ошибки

### GET
Используется для начала игровой сессии. В теле запроса содержатся следующие данные:
    - client_ID - идентификатор клиента (игрока)
    - timestamp - штамп времени инициатора партии в Unix-time
#### Возвращаемые ответы:
    200 - Ok - Запрос выполнен удачно. В теле ответа получены игровые сессии с участием клиента (набор структур содержащих id_session, first_client_id, second_client_id, session_timestamp)
    500 - Internal Server Error - один из сервисов не доступен или в ходе обработки произошли ошибки
#### Доп. параметры
    - session_id - получить сессию по id
    - update - получить уведомления (запросы на игру и т.д.)

### PATCH
Используется для ходов в сессии. В теле запроса содержатся следующие данные:
    - client_ID - идентификатор клиента (игрока)
    - timestamp - штамп времени инициатора партии в Unix-time
    - move - ход в формате FEN/UsFen
#### Возвращаемые ответы:
    200 - Ok - Запрос выполнен удачно.
    403 - Forbidden - ход не прошел валидацию
    500 - Internal Server Error - один из сервисов не доступен или в ходе обработки произошли ошибки

## Общее описание
Сервис получает запросы с клиента и выступает своего рода роутером. Если это запрос на старт игровой сессии, то создает запись для второго игрока с приглашением. Если это ходы, то в первую очередь создает запрос в сервер простой валидации и ждет ответ. Если сервис возвращает, что ход возможен, то оправшивает сервисы валидации доски и сложной валидации. На основании ответов с этих сервисов собирается ответ клиенту и запрос на запись в сервис логирования.
Так же сервис следит за текущими игровыми сессиями. Если в сессии не было ходов больше 15 минут, то состояние доски записывается в базу и сессия удаляется из памяти.
Настройки сервиса (адреса связанных сервисов, таймаут сессий) реализовать через файл YAML